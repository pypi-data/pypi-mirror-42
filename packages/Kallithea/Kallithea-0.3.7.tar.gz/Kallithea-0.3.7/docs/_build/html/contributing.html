
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN"
  "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">

<html xmlns="http://www.w3.org/1999/xhtml">
  <head>
    <meta http-equiv="X-UA-Compatible" content="IE=Edge" />
    <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
    <title>Contributing to Kallithea &#8212; Kallithea 0.3.7 documentation</title>
    <link rel="stylesheet" href="_static/nature.css" type="text/css" />
    <link rel="stylesheet" href="_static/pygments.css" type="text/css" />
    <script type="text/javascript" id="documentation_options" data-url_root="./" src="_static/documentation_options.js"></script>
    <script type="text/javascript" src="_static/jquery.js"></script>
    <script type="text/javascript" src="_static/underscore.js"></script>
    <script type="text/javascript" src="_static/doctools.js"></script>
    <script type="text/javascript" src="_static/language_data.js"></script>
    <link rel="index" title="Index" href="genindex.html" />
    <link rel="search" title="Search" href="search.html" />
    <link rel="next" title="Changelog" href="changelog.html" />
    <link rel="prev" title="Troubleshooting" href="usage/troubleshooting.html" /> 
  </head><body>
    <div class="related" role="navigation" aria-label="related navigation">
      <h3>Navigation</h3>
      <ul>
        <li class="right" style="margin-right: 10px">
          <a href="genindex.html" title="General Index"
             accesskey="I">index</a></li>
        <li class="right" >
          <a href="py-modindex.html" title="Python Module Index"
             >modules</a> |</li>
        <li class="right" >
          <a href="changelog.html" title="Changelog"
             accesskey="N">next</a> |</li>
        <li class="right" >
          <a href="usage/troubleshooting.html" title="Troubleshooting"
             accesskey="P">previous</a> |</li>
        <li class="nav-item nav-item-0"><a href="index.html">Kallithea 0.3.7 documentation</a> &#187;</li> 
      </ul>
    </div>  

    <div class="document">
      <div class="documentwrapper">
        <div class="bodywrapper">
          <div class="body" role="main">
            
  <div class="section" id="contributing-to-kallithea">
<span id="contributing"></span><h1>Contributing to Kallithea<a class="headerlink" href="#contributing-to-kallithea" title="Permalink to this headline">¶</a></h1>
<p>Kallithea is developed and maintained by its users. Please join us and scratch
your own itch.</p>
<div class="section" id="infrastructure">
<h2>Infrastructure<a class="headerlink" href="#infrastructure" title="Permalink to this headline">¶</a></h2>
<p>The main repository is hosted on Our Own Kallithea (aka OOK) at
<a class="reference external" href="https://kallithea-scm.org/repos/kallithea/">https://kallithea-scm.org/repos/kallithea/</a>, our self-hosted instance
of Kallithea.</p>
<p>For now, we use <a class="reference external" href="http://bitbucket.org/">Bitbucket</a> for <a class="reference external" href="https://bitbucket.org/conservancy/kallithea/pull-requests">pull requests</a> and <a class="reference external" href="https://bitbucket.org/conservancy/kallithea/issues?status=new&amp;status=open">issue tracking</a>. The
issue tracker is for tracking bugs, not for support, discussion, or ideas –
please use the <a class="reference external" href="http://lists.sfconservancy.org/mailman/listinfo/kallithea-general">mailing list</a> or <a class="reference internal" href="readme.html#readme"><span class="std std-ref">IRC</span></a> to reach the community.</p>
<p>We use <a class="reference external" href="http://weblate.org/">Weblate</a> to translate the user interface messages into languages other
than English. Join our project on <a class="reference external" href="https://hosted.weblate.org/projects/kallithea/kallithea/">Hosted Weblate</a> to help us.
To register, you can use your Bitbucket or GitHub account. See <a class="reference internal" href="#translations"><span class="std std-ref">Translations</span></a>
for more details.</p>
</div>
<div class="section" id="getting-started">
<h2>Getting started<a class="headerlink" href="#getting-started" title="Permalink to this headline">¶</a></h2>
<p>To get started with development:</p>
<div class="highlight-none notranslate"><div class="highlight"><pre><span></span>hg clone https://kallithea-scm.org/repos/kallithea
cd kallithea
virtualenv ../kallithea-venv
source ../kallithea-venv/bin/activate
pip install --upgrade pip &quot;setuptools&lt;34&quot;
pip install -e .
paster make-config Kallithea my.ini
paster setup-db my.ini --user=user --email=user@example.com --password=password --repos=/tmp
paster serve my.ini --reload &amp;
firefox http://127.0.0.1:5000/
</pre></div>
</div>
<p>You can also start out by forking <a class="reference external" href="https://bitbucket.org/conservancy/kallithea">https://bitbucket.org/conservancy/kallithea</a>
on <a class="reference external" href="http://bitbucket.org/">Bitbucket</a> and create a local clone of your own fork.</p>
</div>
<div class="section" id="running-tests">
<h2>Running tests<a class="headerlink" href="#running-tests" title="Permalink to this headline">¶</a></h2>
<p>After finishing your changes make sure all tests pass cleanly. You can run
the testsuite running <code class="docutils literal notranslate"><span class="pre">nosetests</span></code> from the project root, or if you use tox
run <code class="docutils literal notranslate"><span class="pre">tox</span></code> for Python 2.6–2.7 with multiple database test.</p>
<p>When running tests, Kallithea uses <cite>kallithea/tests/test.ini</cite> and populates the
SQLite database specified there.</p>
<p>It is possible to avoid recreating the full test database on each invocation of
the tests, thus eliminating the initial delay. To achieve this, run the tests as:</p>
<div class="highlight-none notranslate"><div class="highlight"><pre><span></span>paster serve kallithea/tests/test.ini --pid-file=test.pid --daemon
KALLITHEA_WHOOSH_TEST_DISABLE=1 KALLITHEA_NO_TMP_PATH=1 nosetests
kill -9 $(cat test.pid)
</pre></div>
</div>
<p>You can run individual tests by specifying their path as argument to nosetests.
nosetests also has many more options, see <cite>nosetests -h</cite>. Some useful options
are:</p>
<div class="highlight-none notranslate"><div class="highlight"><pre><span></span>-x, --stop            Stop running tests after the first error or failure
-s, --nocapture       Don&#39;t capture stdout (any stdout output will be
                      printed immediately) [NOSE_NOCAPTURE]
--failed              Run the tests that failed in the last test run.
</pre></div>
</div>
</div>
<div class="section" id="coding-contribution-guidelines">
<h2>Coding/contribution guidelines<a class="headerlink" href="#coding-contribution-guidelines" title="Permalink to this headline">¶</a></h2>
<p>Kallithea is GPLv3 and we assume all contributions are made by the
committer/contributor and under GPLv3 unless explicitly stated. We do care a
lot about preservation of copyright and license information for existing code
that is brought into the project.</p>
<p>We don’t have a formal coding/formatting standard. We are currently using a mix
of Mercurial’s (<a class="reference external" href="https://www.mercurial-scm.org/wiki/CodingStyle">https://www.mercurial-scm.org/wiki/CodingStyle</a>), pep8, and
consistency with existing code. Run whitespacecleanup.sh to avoid stupid
whitespace noise in your patches.</p>
<p>We support both Python 2.6.x and 2.7.x and nothing else. For now we don’t care
about Python 3 compatibility.</p>
<p>We try to support the most common modern web browsers. IE9 is still supported
to the extent it is feasible, IE8 is not.</p>
<p>We primarily support Linux and OS X on the server side but Windows should also work.</p>
<p>HTML templates should use 2 spaces for indentation … but be pragmatic. We
should use templates cleverly and avoid duplication. We should use reasonable
semantic markup with element classes and IDs that can be used for styling and testing.
We should only use inline styles in places where it really is semantic (such as
<code class="docutils literal notranslate"><span class="pre">display:</span> <span class="pre">none</span></code>).</p>
<p>JavaScript must use <code class="docutils literal notranslate"><span class="pre">;</span></code> between/after statements. Indentation 4 spaces. Inline
multiline functions should be indented two levels – one for the <code class="docutils literal notranslate"><span class="pre">()</span></code> and one for
<code class="docutils literal notranslate"><span class="pre">{}</span></code>.
Variables holding jQuery objects should be named with a leading <code class="docutils literal notranslate"><span class="pre">$</span></code>.</p>
<p>Commit messages should have a leading short line summarizing the changes. For
bug fixes, put <code class="docutils literal notranslate"><span class="pre">(Issue</span> <span class="pre">#123)</span></code> at the end of this line.</p>
<p>Use American English grammar and spelling overall. Use <a class="reference external" href="https://en.wikipedia.org/wiki/Capitalization#Title_case">English title case</a> for
page titles, button labels, headers, and ‘labels’ for fields in forms.</p>
<p>Contributions will be accepted in most formats – such as pull requests on
bitbucket, something hosted on your own Kallithea instance, or patches sent by
email to the <a class="reference external" href="http://lists.sfconservancy.org/mailman/listinfo/kallithea-general">kallithea-general</a> mailing list.</p>
<p>Make sure to test your changes both manually and with the automatic tests
before posting.</p>
<p>We care about quality and review and keeping a clean repository history. We
might give feedback that requests polishing contributions until they are
“perfect”. We might also rebase and collapse and make minor adjustments to your
changes when we apply them.</p>
<p>We try to make sure we have consensus on the direction the project is taking.
Everything non-sensitive should be discussed in public – preferably on the
mailing list.  We aim at having all non-trivial changes reviewed by at least
one other core developer before pushing. Obvious non-controversial changes will
be handled more casually.</p>
<p>For now we just have one official branch (“default”) and will keep it so stable
that it can be (and is) used in production. Experimental changes should live
elsewhere (for example in a pull request) until they are ready.</p>
</div>
</div>
<div class="section" id="translations">
<span id="id1"></span><h1>Translations<a class="headerlink" href="#translations" title="Permalink to this headline">¶</a></h1>
<p>Translations are available on Hosted Weblate at the following URL:</p>
<blockquote>
<div><a class="reference external" href="https://hosted.weblate.org/projects/kallithea/kallithea/">https://hosted.weblate.org/projects/kallithea/kallithea/</a></div></blockquote>
<p>Registered users may contribute to the existing languages, or request a new
language translations.</p>
<div class="section" id="translating-using-weblate">
<h2>Translating using Weblate<a class="headerlink" href="#translating-using-weblate" title="Permalink to this headline">¶</a></h2>
<p><a class="reference external" href="http://weblate.org/">Weblate</a> offers a simple and easy to use interface featuring glossary, machine
translation, suggestions based on similar translations in other projects,
automatic checks etc. Weblate imports the source code tree directly from
the version control system, and commits edits back from time to time.</p>
<p>When registering at Weblate, make sure you name and email address you prefer to
be used when your changes are committed. We can and probably will amend changesets
coming from Weblate, but having things right from the beginning makes things easier.</p>
<p>Weblate performs sanity checks all the time and tries to prevent you from ignoring
them. Most common mistakes are inconsistent punctuation, whitespaces, missing or extra
format parameters, untranslated strings copied into the translation. Please perform
necessary corrections when they’re needed, or override the false positives.</p>
</div>
<div class="section" id="merging-translations-from-weblate">
<h2>Merging translations from Weblate<a class="headerlink" href="#merging-translations-from-weblate" title="Permalink to this headline">¶</a></h2>
<p>Weblate rebases its changes every time it pulls from our repository. Pulls are triggered
by a web hook from Our Own Kallithea every time it receives new commits. Usually merging
the new translations is a straightforward process consisting of a pull from Weblate-hosted
repository which is available under Data Exports tab in Weblate interface.</p>
<p>Weblate tries to minimise the number of commits, but that’s not always work, especially
when two translators work with different languages at more or less the same time.
It makes sense sometimes to re-order or fold commits by the same author when they touch
just the same language translation. That, however, may confuse Weblate sometimes, in
which case it should be manually convinced it has to discard the commits it created by
using its administrative interface.</p>
</div>
<div class="section" id="manual-creation-of-a-new-language-translation">
<h2>Manual creation of a new language translation<a class="headerlink" href="#manual-creation-of-a-new-language-translation" title="Permalink to this headline">¶</a></h2>
<p>In the prepared development environment, run the following to ensure
all translation strings are extracted and up-to-date:</p>
<div class="highlight-none notranslate"><div class="highlight"><pre><span></span>python2 setup.py extract_messages
</pre></div>
</div>
<p>Create new language by executing following command:</p>
<div class="highlight-none notranslate"><div class="highlight"><pre><span></span>python2 setup.py init_catalog -l &lt;new_language_code&gt;
</pre></div>
</div>
<p>This creates a new translation under directory <cite>kallithea/i18n/&lt;new_language_code&gt;</cite>
based on the translation template file, <cite>kallithea/i18n/kallithea.pot</cite>.</p>
<p>Edit the new PO file located in <cite>LC_MESSAGES</cite> directory with poedit or your
favorite PO files editor. After you finished with the translations, check the
translation file for errors by executing:</p>
<div class="highlight-none notranslate"><div class="highlight"><pre><span></span>msgfmt -f -c kallithea/i18n/&lt;new_language_code&gt;/LC_MESSAGES/&lt;updated_file.po&gt;
</pre></div>
</div>
<p>Finally, compile the translations:</p>
<div class="highlight-none notranslate"><div class="highlight"><pre><span></span>python2 setup.py compile_catalog -l &lt;new_language_code&gt;
</pre></div>
</div>
</div>
<div class="section" id="updating-translations">
<h2>Updating translations<a class="headerlink" href="#updating-translations" title="Permalink to this headline">¶</a></h2>
<p>Extract the latest versions of strings for translation by running:</p>
<div class="highlight-none notranslate"><div class="highlight"><pre><span></span>python2 setup.py extract_messages
</pre></div>
</div>
<p>Update the PO file by doing:</p>
<div class="highlight-none notranslate"><div class="highlight"><pre><span></span>python2 setup.py update_catalog -l &lt;new_language_code&gt;
</pre></div>
</div>
<p>Edit the new updated translation file. Repeat all steps after <cite>init_catalog</cite> step from
new translation instructions</p>
</div>
<div class="section" id="testing-translations">
<h2>Testing translations<a class="headerlink" href="#testing-translations" title="Permalink to this headline">¶</a></h2>
<p>Edit kallithea/tests/test.ini file and set lang attribute to:</p>
<div class="highlight-none notranslate"><div class="highlight"><pre><span></span>lang=&lt;new_language_code&gt;
</pre></div>
</div>
<p>Run Kallithea tests by executing:</p>
<div class="highlight-none notranslate"><div class="highlight"><pre><span></span>nosetests
</pre></div>
</div>
</div>
<div class="section" id="roadmap">
<h2>“Roadmap”<a class="headerlink" href="#roadmap" title="Permalink to this headline">¶</a></h2>
<p>We do not have a road map but are waiting for your contributions. Refer to the
<a class="reference external" href="https://bitbucket.org/conservancy/kallithea/wiki/Home">wiki</a> for some ideas of places we might want to go – contributions in these
areas are very welcome.</p>
</div>
<div class="section" id="thank-you-for-your-contribution">
<h2>Thank you for your contribution!<a class="headerlink" href="#thank-you-for-your-contribution" title="Permalink to this headline">¶</a></h2>
</div>
</div>


          </div>
        </div>
      </div>
      <div class="sphinxsidebar" role="navigation" aria-label="main navigation">
        <div class="sphinxsidebarwrapper">
<div style="text-align:center;margin:30px 0;">
  <img src="_static/kallithea-logo.svg" width="200px"/>
</div>
<h3>Support Kallithea development</h3>
<div style="text-align:center">
<form action="https://www.paypal.com/cgi-bin/webscr" method="post" target="_top">
<input type="hidden" name="cmd" value="_s-xclick">
<input type="hidden" name="hosted_button_id" value="EYXFS3SQPHYUL">
<input type="image" src="https://www.paypalobjects.com/en_US/i/btn/btn_donateCC_LG.gif" border="0" name="submit" alt="PayPal &ndash; The safer, easier way to pay online!">
<img alt="" border="0" src="https://www.paypalobjects.com/en_US/i/scr/pixel.gif" width="1" height="1">
</form>
    <div style="padding:5px">
     <a href="https://flattr.com/thing/922714/Donate-to-Software-Freedom-Conservancy" target="_blank">
     <img src="http://api.flattr.com/button/flattr-badge-large.png" alt="Flattr this" title="Flattr this" border="0" /></a>
    </div>
</div>

  <h3><a href="index.html">Table of Contents</a></h3>
  <ul>
<li><a class="reference internal" href="#">Contributing to Kallithea</a><ul>
<li><a class="reference internal" href="#infrastructure">Infrastructure</a></li>
<li><a class="reference internal" href="#getting-started">Getting started</a></li>
<li><a class="reference internal" href="#running-tests">Running tests</a></li>
<li><a class="reference internal" href="#coding-contribution-guidelines">Coding/contribution guidelines</a></li>
</ul>
</li>
<li><a class="reference internal" href="#translations">Translations</a><ul>
<li><a class="reference internal" href="#translating-using-weblate">Translating using Weblate</a></li>
<li><a class="reference internal" href="#merging-translations-from-weblate">Merging translations from Weblate</a></li>
<li><a class="reference internal" href="#manual-creation-of-a-new-language-translation">Manual creation of a new language translation</a></li>
<li><a class="reference internal" href="#updating-translations">Updating translations</a></li>
<li><a class="reference internal" href="#testing-translations">Testing translations</a></li>
<li><a class="reference internal" href="#roadmap">“Roadmap”</a></li>
<li><a class="reference internal" href="#thank-you-for-your-contribution">Thank you for your contribution!</a></li>
</ul>
</li>
</ul>

  <h4>Previous topic</h4>
  <p class="topless"><a href="usage/troubleshooting.html"
                        title="previous chapter">Troubleshooting</a></p>
  <h4>Next topic</h4>
  <p class="topless"><a href="changelog.html"
                        title="next chapter">Changelog</a></p>
  <div role="note" aria-label="source link">
    <h3>This Page</h3>
    <ul class="this-page-menu">
      <li><a href="_sources/contributing.rst.txt"
            rel="nofollow">Show Source</a></li>
    </ul>
   </div>
<div id="searchbox" style="display: none" role="search">
  <h3>Quick search</h3>
    <div class="searchformwrapper">
    <form class="search" action="search.html" method="get">
      <input type="text" name="q" />
      <input type="submit" value="Go" />
      <input type="hidden" name="check_keywords" value="yes" />
      <input type="hidden" name="area" value="default" />
    </form>
    </div>
</div>
<script type="text/javascript">$('#searchbox').show(0);</script>
        </div>
      </div>
      <div class="clearer"></div>
    </div>
    <div class="related" role="navigation" aria-label="related navigation">
      <h3>Navigation</h3>
      <ul>
        <li class="right" style="margin-right: 10px">
          <a href="genindex.html" title="General Index"
             >index</a></li>
        <li class="right" >
          <a href="py-modindex.html" title="Python Module Index"
             >modules</a> |</li>
        <li class="right" >
          <a href="changelog.html" title="Changelog"
             >next</a> |</li>
        <li class="right" >
          <a href="usage/troubleshooting.html" title="Troubleshooting"
             >previous</a> |</li>
        <li class="nav-item nav-item-0"><a href="index.html">Kallithea 0.3.7 documentation</a> &#187;</li> 
      </ul>
    </div>
    <div class="footer" role="contentinfo">
        &#169; Copyright 2010-2016 by various authors, licensed as GPLv3..
      Created using <a href="http://sphinx-doc.org/">Sphinx</a> 1.8.4.
    </div>
  </body>
</html>