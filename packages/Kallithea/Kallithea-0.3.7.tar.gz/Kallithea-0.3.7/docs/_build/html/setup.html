
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN"
  "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">

<html xmlns="http://www.w3.org/1999/xhtml">
  <head>
    <meta http-equiv="X-UA-Compatible" content="IE=Edge" />
    <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
    <title>Setup &#8212; Kallithea 0.3.7 documentation</title>
    <link rel="stylesheet" href="_static/nature.css" type="text/css" />
    <link rel="stylesheet" href="_static/pygments.css" type="text/css" />
    <script type="text/javascript" id="documentation_options" data-url_root="./" src="_static/documentation_options.js"></script>
    <script type="text/javascript" src="_static/jquery.js"></script>
    <script type="text/javascript" src="_static/underscore.js"></script>
    <script type="text/javascript" src="_static/doctools.js"></script>
    <script type="text/javascript" src="_static/language_data.js"></script>
    <link rel="index" title="Index" href="genindex.html" />
    <link rel="search" title="Search" href="search.html" />
    <link rel="next" title="Installation and setup using Puppet" href="installation_puppet.html" />
    <link rel="prev" title="Installing Kallithea on Microsoft Internet Information Services (IIS)" href="installation_iis.html" /> 
  </head><body>
    <div class="related" role="navigation" aria-label="related navigation">
      <h3>Navigation</h3>
      <ul>
        <li class="right" style="margin-right: 10px">
          <a href="genindex.html" title="General Index"
             accesskey="I">index</a></li>
        <li class="right" >
          <a href="py-modindex.html" title="Python Module Index"
             >modules</a> |</li>
        <li class="right" >
          <a href="installation_puppet.html" title="Installation and setup using Puppet"
             accesskey="N">next</a> |</li>
        <li class="right" >
          <a href="installation_iis.html" title="Installing Kallithea on Microsoft Internet Information Services (IIS)"
             accesskey="P">previous</a> |</li>
        <li class="nav-item nav-item-0"><a href="index.html">Kallithea 0.3.7 documentation</a> &#187;</li> 
      </ul>
    </div>  

    <div class="document">
      <div class="documentwrapper">
        <div class="bodywrapper">
          <div class="body" role="main">
            
  <div class="section" id="setup">
<span id="id1"></span><h1>Setup<a class="headerlink" href="#setup" title="Permalink to this headline">¶</a></h1>
<div class="section" id="setting-up-kallithea">
<h2>Setting up Kallithea<a class="headerlink" href="#setting-up-kallithea" title="Permalink to this headline">¶</a></h2>
<p>First, you will need to create a Kallithea configuration file. Run the
following command to do so:</p>
<div class="highlight-none notranslate"><div class="highlight"><pre><span></span>paster make-config Kallithea my.ini
</pre></div>
</div>
<p>This will create the file <code class="docutils literal notranslate"><span class="pre">my.ini</span></code> in the current directory. This
configuration file contains the various settings for Kallithea, e.g.
proxy port, email settings, usage of static files, cache, Celery
settings, and logging.</p>
<p>Next, you need to create the databases used by Kallithea. It is recommended to
use PostgreSQL or SQLite (default). If you choose a database other than the
default, ensure you properly adjust the database URL in your <code class="docutils literal notranslate"><span class="pre">my.ini</span></code>
configuration file to use this other database. Kallithea currently supports
PostgreSQL, SQLite and MySQL databases. Create the database by running
the following command:</p>
<div class="highlight-none notranslate"><div class="highlight"><pre><span></span>paster setup-db my.ini
</pre></div>
</div>
<p>This will prompt you for a “root” path. This “root” path is the location where
Kallithea will store all of its repositories on the current machine. After
entering this “root” path <code class="docutils literal notranslate"><span class="pre">setup-db</span></code> will also prompt you for a username
and password for the initial admin account which <code class="docutils literal notranslate"><span class="pre">setup-db</span></code> sets
up for you.</p>
<p>The <code class="docutils literal notranslate"><span class="pre">setup-db</span></code> values can also be given on the command line.
Example:</p>
<div class="highlight-none notranslate"><div class="highlight"><pre><span></span>paster setup-db my.ini --user=nn --password=secret --email=nn@example.com --repos=/srv/repos
</pre></div>
</div>
<p>The <code class="docutils literal notranslate"><span class="pre">setup-db</span></code> command will create all needed tables and an
admin account. When choosing a root path you can either use a new
empty location, or a location which already contains existing
repositories. If you choose a location which contains existing
repositories Kallithea will add all of the repositories at the chosen
location to its database.  (Note: make sure you specify the correct
path to the root).</p>
<div class="admonition note">
<p class="first admonition-title">Note</p>
<p class="last">the given path for <a class="reference external" href="https://www.mercurial-scm.org/">Mercurial</a> repositories <strong>must</strong> be write
accessible for the application. It’s very important since
the Kallithea web interface will work without write access,
but when trying to do a push it will fail with permission
denied errors unless it has write access.</p>
</div>
<p>You are now ready to use Kallithea. To run it simply execute:</p>
<div class="highlight-none notranslate"><div class="highlight"><pre><span></span>paster serve my.ini
</pre></div>
</div>
<ul class="simple">
<li>This command runs the Kallithea server. The web app should be available at
<a class="reference external" href="http://127.0.0.1:5000">http://127.0.0.1:5000</a>. The IP address and port is configurable via the
configuration file created in the previous step.</li>
<li>Log in to Kallithea using the admin account created when running <code class="docutils literal notranslate"><span class="pre">setup-db</span></code>.</li>
<li>The default permissions on each repository is read, and the owner is admin.
Remember to update these if needed.</li>
<li>In the admin panel you can toggle LDAP, anonymous, and permissions
settings, as well as edit more advanced options on users and
repositories.</li>
</ul>
</div>
<div class="section" id="extensions">
<h2>Extensions<a class="headerlink" href="#extensions" title="Permalink to this headline">¶</a></h2>
<p>Optionally one can create an <code class="docutils literal notranslate"><span class="pre">rcextensions</span></code> package that extends Kallithea
functionality.
To generate a skeleton extensions package, run:</p>
<div class="highlight-none notranslate"><div class="highlight"><pre><span></span>paster make-rcext my.ini
</pre></div>
</div>
<p>This will create an <code class="docutils literal notranslate"><span class="pre">rcextensions</span></code> package next to the specified <code class="docutils literal notranslate"><span class="pre">ini</span></code> file.
With <code class="docutils literal notranslate"><span class="pre">rcextensions</span></code> it’s possible to add additional mapping for whoosh,
stats and add additional code into the push/pull/create/delete repo hooks,
for example for sending signals to build-bots such as Jenkins.</p>
<p>See the <code class="docutils literal notranslate"><span class="pre">__init__.py</span></code> file inside the generated <code class="docutils literal notranslate"><span class="pre">rcextensions</span></code> package
for more details.</p>
</div>
<div class="section" id="using-kallithea-with-ssh">
<h2>Using Kallithea with SSH<a class="headerlink" href="#using-kallithea-with-ssh" title="Permalink to this headline">¶</a></h2>
<p>Kallithea currently only hosts repositories using http and https. (The addition
of ssh hosting is a planned future feature.) However you can easily use ssh in
parallel with Kallithea. (Repository access via ssh is a standard “out of
the box” feature of <a class="reference external" href="https://www.mercurial-scm.org/">Mercurial</a> and you can use this to access any of the
repositories that Kallithea is hosting. See <a class="reference external" href="https://www.mercurial-scm.org/wiki/PublishingRepositories">PublishingRepositories</a>)</p>
<p>Kallithea repository structures are kept in directories with the same name
as the project. When using repository groups, each group is a subdirectory.
This allows you to easily use ssh for accessing repositories.</p>
<p>In order to use ssh you need to make sure that your web server and the users’
login accounts have the correct permissions set on the appropriate directories.</p>
<div class="admonition note">
<p class="first admonition-title">Note</p>
<p class="last">These permissions are independent of any permissions you
have set up using the Kallithea web interface.</p>
</div>
<p>If your main directory (the same as set in Kallithea settings) is for
example set to <code class="docutils literal notranslate"><span class="pre">/srv/repos</span></code> and the repository you are using is
named <code class="docutils literal notranslate"><span class="pre">kallithea</span></code>, then to clone via ssh you should run:</p>
<div class="highlight-none notranslate"><div class="highlight"><pre><span></span>hg clone ssh://user@kallithea.example.com/srv/repos/kallithea
</pre></div>
</div>
<p>Using other external tools such as <a class="reference external" href="http://www.lshift.net/mercurial-server.html">mercurial-server</a> or using ssh key-based
authentication is fully supported.</p>
<div class="admonition note">
<p class="first admonition-title">Note</p>
<p class="last">In an advanced setup, in order for your ssh access to use
the same permissions as set up via the Kallithea web
interface, you can create an authentication hook to connect
to the Kallithea db and run check functions for permissions
against that.</p>
</div>
</div>
<div class="section" id="setting-up-whoosh-full-text-search">
<h2>Setting up Whoosh full text search<a class="headerlink" href="#setting-up-whoosh-full-text-search" title="Permalink to this headline">¶</a></h2>
<p>Kallithea provides full text search of repositories using <a class="reference external" href="https://whoosh.readthedocs.io/en/latest/">Whoosh</a>.</p>
<p>For an incremental index build, run:</p>
<div class="highlight-none notranslate"><div class="highlight"><pre><span></span>paster make-index my.ini
</pre></div>
</div>
<p>For a full index rebuild, run:</p>
<div class="highlight-none notranslate"><div class="highlight"><pre><span></span>paster make-index my.ini -f
</pre></div>
</div>
<p>The <code class="docutils literal notranslate"><span class="pre">--repo-location</span></code> option allows the location of the repositories to be overriden;
usually, the location is retrieved from the Kallithea database.</p>
<p>The <code class="docutils literal notranslate"><span class="pre">--index-only</span></code> option can be used to limit the indexed repositories to a comma-separated list:</p>
<div class="highlight-none notranslate"><div class="highlight"><pre><span></span>paster make-index my.ini --index-only=vcs,kallithea
</pre></div>
</div>
<p>To keep your index up-to-date it is necessary to do periodic index builds;
for this, it is recommended to use a crontab entry. Example:</p>
<div class="highlight-none notranslate"><div class="highlight"><pre><span></span>0  3  *  *  *  /path/to/virtualenv/bin/paster make-index /path/to/kallithea/my.ini
</pre></div>
</div>
<p>When using incremental mode (the default), Whoosh will check the last
modification date of each file and add it to be reindexed if a newer file is
available. The indexing daemon checks for any removed files and removes them
from index.</p>
<p>If you want to rebuild the index from scratch, you can use the <code class="docutils literal notranslate"><span class="pre">-f</span></code> flag as above,
or in the admin panel you can check the “build from scratch” checkbox.</p>
</div>
<div class="section" id="setting-up-ldap-support">
<span id="ldap-setup"></span><h2>Setting up LDAP support<a class="headerlink" href="#setting-up-ldap-support" title="Permalink to this headline">¶</a></h2>
<p>Kallithea supports LDAP authentication. In order
to use LDAP, you have to install the <a class="reference external" href="http://www.python-ldap.org/">python-ldap</a> package. This package is
available via PyPI, so you can install it by running:</p>
<div class="highlight-none notranslate"><div class="highlight"><pre><span></span>pip install python-ldap
</pre></div>
</div>
<div class="admonition note">
<p class="first admonition-title">Note</p>
<p class="last"><code class="docutils literal notranslate"><span class="pre">python-ldap</span></code> requires some libraries to be installed on
your system, so before installing it check that you have at
least the <code class="docutils literal notranslate"><span class="pre">openldap</span></code> and <code class="docutils literal notranslate"><span class="pre">sasl</span></code> libraries.</p>
</div>
<p>Choose <em>Admin &gt; Authentication</em>, click the <code class="docutils literal notranslate"><span class="pre">kallithea.lib.auth_modules.auth_ldap</span></code> button
and then <em>Save</em>, to enable the LDAP plugin and configure its settings.</p>
<p>Here’s a typical LDAP setup:</p>
<div class="highlight-none notranslate"><div class="highlight"><pre><span></span>Connection settings
Enable LDAP          = checked
Host                 = host.example.com
Port                 = 389
Account              = &lt;account&gt;
Password             = &lt;password&gt;
Connection Security  = LDAPS connection
Certificate Checks   = DEMAND

Search settings
Base DN              = CN=users,DC=host,DC=example,DC=org
LDAP Filter          = (&amp;(objectClass=user)(!(objectClass=computer)))
LDAP Search Scope    = SUBTREE

Attribute mappings
Login Attribute      = uid
First Name Attribute = firstName
Last Name Attribute  = lastName
Email Attribute      = mail
</pre></div>
</div>
<p>If your user groups are placed in an Organisation Unit (OU) structure, the Search Settings configuration differs:</p>
<div class="highlight-none notranslate"><div class="highlight"><pre><span></span>Search settings
Base DN              = DC=host,DC=example,DC=org
LDAP Filter          = (&amp;(memberOf=CN=your user group,OU=subunit,OU=unit,DC=host,DC=example,DC=org)(objectClass=user))
LDAP Search Scope    = SUBTREE
</pre></div>
</div>
<dl class="docutils" id="enable-ldap">
<dt>Enable LDAP <span class="classifier-delimiter">:</span> <span class="classifier">required</span></dt>
<dd>Whether to use LDAP for authenticating users.</dd>
</dl>
<dl class="docutils" id="ldap-host">
<dt>Host <span class="classifier-delimiter">:</span> <span class="classifier">required</span></dt>
<dd>LDAP server hostname or IP address. Can be also a comma separated
list of servers to support LDAP fail-over.</dd>
</dl>
<dl class="docutils" id="port">
<dt>Port <span class="classifier-delimiter">:</span> <span class="classifier">required</span></dt>
<dd>389 for un-encrypted LDAP, 636 for SSL-encrypted LDAP.</dd>
</dl>
<dl class="docutils" id="ldap-account">
<dt>Account <span class="classifier-delimiter">:</span> <span class="classifier">optional</span></dt>
<dd>Only required if the LDAP server does not allow anonymous browsing of
records.  This should be a special account for record browsing.  This
will require <a class="reference internal" href="#ldap-password">LDAP Password</a> below.</dd>
</dl>
<dl class="docutils" id="ldap-password">
<dt>Password <span class="classifier-delimiter">:</span> <span class="classifier">optional</span></dt>
<dd>Only required if the LDAP server does not allow anonymous browsing of
records.</dd>
</dl>
<dl class="docutils" id="enable-ldaps">
<dt>Connection Security <span class="classifier-delimiter">:</span> <span class="classifier">required</span></dt>
<dd><p class="first">Defines the connection to LDAP server</p>
<dl class="last docutils">
<dt>No encryption</dt>
<dd>Plain non encrypted connection</dd>
<dt>LDAPS connection</dt>
<dd>Enable LDAPS connections. It will likely require <a class="reference internal" href="#port">Port</a> to be set to
a different value (standard LDAPS port is 636). When LDAPS is enabled
then <a class="reference internal" href="#certificate-checks">Certificate Checks</a> is required.</dd>
<dt>START_TLS on LDAP connection</dt>
<dd>START TLS connection</dd>
</dl>
</dd>
</dl>
<dl class="docutils" id="certificate-checks">
<dt>Certificate Checks <span class="classifier-delimiter">:</span> <span class="classifier">optional</span></dt>
<dd><p class="first">How SSL certificates verification is handled – this is only useful when
<a class="reference internal" href="#enable-ldaps">Enable LDAPS</a> is enabled.  Only DEMAND or HARD offer full SSL security
while the other options are susceptible to man-in-the-middle attacks.  SSL
certificates can be installed to /etc/openldap/cacerts so that the
DEMAND or HARD options can be used with self-signed certificates or
certificates that do not have traceable certificates of authority.</p>
<dl class="last docutils">
<dt>NEVER</dt>
<dd>A serve certificate will never be requested or checked.</dd>
<dt>ALLOW</dt>
<dd>A server certificate is requested.  Failure to provide a
certificate or providing a bad certificate will not terminate the
session.</dd>
<dt>TRY</dt>
<dd>A server certificate is requested.  Failure to provide a
certificate does not halt the session; providing a bad certificate
halts the session.</dd>
<dt>DEMAND</dt>
<dd>A server certificate is requested and must be provided and
authenticated for the session to proceed.</dd>
<dt>HARD</dt>
<dd>The same as DEMAND.</dd>
</dl>
</dd>
</dl>
<dl class="docutils" id="base-dn">
<dt>Base DN <span class="classifier-delimiter">:</span> <span class="classifier">required</span></dt>
<dd>The Distinguished Name (DN) where searches for users will be performed.
Searches can be controlled by <a class="reference internal" href="#ldap-filter">LDAP Filter</a> and <a class="reference internal" href="#ldap-search-scope">LDAP Search Scope</a>.</dd>
</dl>
<dl class="docutils" id="ldap-filter">
<dt>LDAP Filter <span class="classifier-delimiter">:</span> <span class="classifier">optional</span></dt>
<dd>A LDAP filter defined by RFC 2254.  This is more useful when <a class="reference internal" href="#ldap-search-scope">LDAP
Search Scope</a> is set to SUBTREE.  The filter is useful for limiting
which LDAP objects are identified as representing Users for
authentication.  The filter is augmented by <a class="reference internal" href="#login-attribute">Login Attribute</a> below.
This can commonly be left blank.</dd>
</dl>
<dl class="docutils" id="ldap-search-scope">
<dt>LDAP Search Scope <span class="classifier-delimiter">:</span> <span class="classifier">required</span></dt>
<dd><p class="first">This limits how far LDAP will search for a matching object.</p>
<dl class="last docutils">
<dt>BASE</dt>
<dd>Only allows searching of <a class="reference internal" href="#base-dn">Base DN</a> and is usually not what you
want.</dd>
<dt>ONELEVEL</dt>
<dd>Searches all entries under <a class="reference internal" href="#base-dn">Base DN</a>, but not Base DN itself.</dd>
<dt>SUBTREE</dt>
<dd>Searches all entries below <a class="reference internal" href="#base-dn">Base DN</a>, but not Base DN itself.
When using SUBTREE <a class="reference internal" href="#ldap-filter">LDAP Filter</a> is useful to limit object
location.</dd>
</dl>
</dd>
</dl>
<dl class="docutils" id="login-attribute">
<dt>Login Attribute <span class="classifier-delimiter">:</span> <span class="classifier">required</span></dt>
<dd><p class="first">The LDAP record attribute that will be matched as the USERNAME or
ACCOUNT used to connect to Kallithea.  This will be added to <a class="reference internal" href="#ldap-filter">LDAP
Filter</a> for locating the User object.  If <a class="reference internal" href="#ldap-filter">LDAP Filter</a> is specified as
“LDAPFILTER”, <a class="reference internal" href="#login-attribute">Login Attribute</a> is specified as “uid” and the user has
connected as “jsmith” then the <a class="reference internal" href="#ldap-filter">LDAP Filter</a> will be augmented as below</p>
<div class="last highlight-none notranslate"><div class="highlight"><pre><span></span>(&amp;(LDAPFILTER)(uid=jsmith))
</pre></div>
</div>
</dd>
</dl>
<dl class="docutils" id="ldap-attr-firstname">
<dt>First Name Attribute <span class="classifier-delimiter">:</span> <span class="classifier">required</span></dt>
<dd>The LDAP record attribute which represents the user’s first name.</dd>
</dl>
<dl class="docutils" id="ldap-attr-lastname">
<dt>Last Name Attribute <span class="classifier-delimiter">:</span> <span class="classifier">required</span></dt>
<dd>The LDAP record attribute which represents the user’s last name.</dd>
</dl>
<dl class="docutils" id="ldap-attr-email">
<dt>Email Attribute <span class="classifier-delimiter">:</span> <span class="classifier">required</span></dt>
<dd>The LDAP record attribute which represents the user’s email address.</dd>
</dl>
<p>If all data are entered correctly, and <a class="reference external" href="http://www.python-ldap.org/">python-ldap</a> is properly installed
users should be granted access to Kallithea with LDAP accounts.  At this
time user information is copied from LDAP into the Kallithea user database.
This means that updates of an LDAP user object may not be reflected as a
user update in Kallithea.</p>
<p>If You have problems with LDAP access and believe You entered correct
information check out the Kallithea logs, any error messages sent from LDAP
will be saved there.</p>
<div class="section" id="active-directory">
<h3>Active Directory<a class="headerlink" href="#active-directory" title="Permalink to this headline">¶</a></h3>
<p>Kallithea can use Microsoft Active Directory for user authentication.  This
is done through an LDAP or LDAPS connection to Active Directory.  The
following LDAP configuration settings are typical for using Active
Directory</p>
<div class="highlight-none notranslate"><div class="highlight"><pre><span></span>Base DN              = OU=SBSUsers,OU=Users,OU=MyBusiness,DC=v3sys,DC=local
Login Attribute      = sAMAccountName
First Name Attribute = givenName
Last Name Attribute  = sn
Email Attribute     = mail
</pre></div>
</div>
<p>All other LDAP settings will likely be site-specific and should be
appropriately configured.</p>
</div>
</div>
<div class="section" id="authentication-by-container-or-reverse-proxy">
<h2>Authentication by container or reverse-proxy<a class="headerlink" href="#authentication-by-container-or-reverse-proxy" title="Permalink to this headline">¶</a></h2>
<p>Kallithea supports delegating the authentication
of users to its WSGI container, or to a reverse-proxy server through which all
clients access the application.</p>
<p>When these authentication methods are enabled in Kallithea, it uses the
username that the container/proxy (Apache or Nginx, etc.) provides and doesn’t
perform the authentication itself. The authorization, however, is still done by
Kallithea according to its settings.</p>
<p>When a user logs in for the first time using these authentication methods,
a matching user account is created in Kallithea with default permissions. An
administrator can then modify it using Kallithea’s admin interface.</p>
<p>It’s also possible for an administrator to create accounts and configure their
permissions before the user logs in for the first time, using the <a class="reference internal" href="api/api.html#create-user"><span class="std std-ref">create_user</span></a> API.</p>
<div class="section" id="container-based-authentication">
<h3>Container-based authentication<a class="headerlink" href="#container-based-authentication" title="Permalink to this headline">¶</a></h3>
<p>In a container-based authentication setup, Kallithea reads the user name from
the <code class="docutils literal notranslate"><span class="pre">REMOTE_USER</span></code> server variable provided by the WSGI container.</p>
<p>After setting up your container (see <a class="reference internal" href="#apache-with-mod-wsgi">Apache with mod_wsgi</a>), you’ll need
to configure it to require authentication on the location configured for
Kallithea.</p>
</div>
<div class="section" id="proxy-pass-through-authentication">
<h3>Proxy pass-through authentication<a class="headerlink" href="#proxy-pass-through-authentication" title="Permalink to this headline">¶</a></h3>
<p>In a proxy pass-through authentication setup, Kallithea reads the user name
from the <code class="docutils literal notranslate"><span class="pre">X-Forwarded-User</span></code> request header, which should be configured to be
sent by the reverse-proxy server.</p>
<p>After setting up your proxy solution (see <a class="reference internal" href="#apache-virtual-host-reverse-proxy-example">Apache virtual host reverse proxy example</a>,
<a class="reference internal" href="#apache-as-subdirectory">Apache as subdirectory</a> or <a class="reference internal" href="#nginx-virtual-host-example">Nginx virtual host example</a>), you’ll need to
configure the authentication and add the username in a request header named
<code class="docutils literal notranslate"><span class="pre">X-Forwarded-User</span></code>.</p>
<p>For example, the following config section for Apache sets a subdirectory in a
reverse-proxy setup with basic auth:</p>
<div class="highlight-apache notranslate"><div class="highlight"><pre><span></span><span class="nt">&lt;Location</span> <span class="s">/someprefix</span><span class="nt">&gt;</span>
  <span class="nb">ProxyPass</span> http://127.0.0.1:5000/someprefix
  <span class="nb">ProxyPassReverse</span> http://127.0.0.1:5000/someprefix
  <span class="nb">SetEnvIf</span> X-Url-Scheme https HTTPS=1

  <span class="nb">AuthType</span> Basic
  <span class="nb">AuthName</span> <span class="s2">&quot;Kallithea authentication&quot;</span>
  <span class="nb">AuthUserFile</span> <span class="sx">/srv/kallithea/.htpasswd</span>
  <span class="nb">Require</span> valid-user

  <span class="nb">RequestHeader</span> unset X-Forwarded-User

  <span class="nb">RewriteEngine</span> <span class="k">On</span>
  <span class="nb">RewriteCond</span> %{LA-U:REMOTE_USER} (.+)
  <span class="nb">RewriteRule</span> .* - [E=RU:%1]
  <span class="nb">RequestHeader</span> set X-Forwarded-User %{RU}e
<span class="nt">&lt;/Location&gt;</span>
</pre></div>
</div>
<div class="admonition note">
<p class="first admonition-title">Note</p>
<p class="last">If you enable proxy pass-through authentication, make sure your server is
only accessible through the proxy. Otherwise, any client would be able to
forge the authentication header and could effectively become authenticated
using any account of their liking.</p>
</div>
</div>
</div>
<div class="section" id="integration-with-issue-trackers">
<h2>Integration with issue trackers<a class="headerlink" href="#integration-with-issue-trackers" title="Permalink to this headline">¶</a></h2>
<p>Kallithea provides a simple integration with issue trackers. It’s possible
to define a regular expression that will match an issue ID in commit messages,
and have that replaced with a URL to the issue. To enable this simply
uncomment the following variables in the ini file:</p>
<div class="highlight-none notranslate"><div class="highlight"><pre><span></span>issue_pat = (?:^#|\s#)(\w+)
issue_server_link = https://issues.example.com/{repo}/issue/{id}
issue_prefix = #
</pre></div>
</div>
<p><code class="docutils literal notranslate"><span class="pre">issue_pat</span></code> is the regular expression describing which strings in
commit messages will be treated as issue references. A match group in
parentheses should be used to specify the actual issue id.</p>
<p>The default expression matches issues in the format <code class="docutils literal notranslate"><span class="pre">#&lt;number&gt;</span></code>, e.g., <code class="docutils literal notranslate"><span class="pre">#300</span></code>.</p>
<p>Matched issue references are replaced with the link specified in
<code class="docutils literal notranslate"><span class="pre">issue_server_link</span></code>. <code class="docutils literal notranslate"><span class="pre">{id}</span></code> is replaced with the issue ID, and
<code class="docutils literal notranslate"><span class="pre">{repo}</span></code> with the repository name.  Since the # is stripped away,
<code class="docutils literal notranslate"><span class="pre">issue_prefix</span></code> is prepended to the link text.  <code class="docutils literal notranslate"><span class="pre">issue_prefix</span></code> doesn’t
necessarily need to be <code class="docutils literal notranslate"><span class="pre">#</span></code>: if you set issue prefix to <code class="docutils literal notranslate"><span class="pre">ISSUE-</span></code> this will
generate a URL in the format:</p>
<div class="highlight-html notranslate"><div class="highlight"><pre><span></span><span class="p">&lt;</span><span class="nt">a</span> <span class="na">href</span><span class="o">=</span><span class="s">&quot;https://issues.example.com/example_repo/issue/300&quot;</span><span class="p">&gt;</span>ISSUE-300<span class="p">&lt;/</span><span class="nt">a</span><span class="p">&gt;</span>
</pre></div>
</div>
<p>If needed, more than one pattern can be specified by appending a unique suffix to
the variables. For example:</p>
<div class="highlight-none notranslate"><div class="highlight"><pre><span></span>issue_pat_wiki = (?:wiki-)(.+)
issue_server_link_wiki = https://wiki.example.com/{id}
issue_prefix_wiki = WIKI-
</pre></div>
</div>
<p>With these settings, wiki pages can be referenced as wiki-some-id, and every
such reference will be transformed into:</p>
<div class="highlight-html notranslate"><div class="highlight"><pre><span></span><span class="p">&lt;</span><span class="nt">a</span> <span class="na">href</span><span class="o">=</span><span class="s">&quot;https://wiki.example.com/some-id&quot;</span><span class="p">&gt;</span>WIKI-some-id<span class="p">&lt;/</span><span class="nt">a</span><span class="p">&gt;</span>
</pre></div>
</div>
</div>
<div class="section" id="hook-management">
<h2>Hook management<a class="headerlink" href="#hook-management" title="Permalink to this headline">¶</a></h2>
<p>Hooks can be managed in similar way to that used in <code class="docutils literal notranslate"><span class="pre">.hgrc</span></code> files.
To manage hooks, choose <em>Admin &gt; Settings &gt; Hooks</em>.</p>
<p>The built-in hooks cannot be modified, though they can be enabled or disabled in the <em>VCS</em> section.</p>
<p>To add another custom hook simply fill in the first textbox with
<code class="docutils literal notranslate"><span class="pre">&lt;name&gt;.&lt;hook_type&gt;</span></code> and the second with the hook path. Example hooks
can be found in <code class="docutils literal notranslate"><span class="pre">kallithea.lib.hooks</span></code>.</p>
</div>
<div class="section" id="changing-default-encoding">
<h2>Changing default encoding<a class="headerlink" href="#changing-default-encoding" title="Permalink to this headline">¶</a></h2>
<p>By default, Kallithea uses UTF-8 encoding.
This is configurable as <code class="docutils literal notranslate"><span class="pre">default_encoding</span></code> in the .ini file.
This affects many parts in Kallithea including user names, filenames, and
encoding of commit messages. In addition Kallithea can detect if the <code class="docutils literal notranslate"><span class="pre">chardet</span></code>
library is installed. If <code class="docutils literal notranslate"><span class="pre">chardet</span></code> is detected Kallithea will fallback to it
when there are encode/decode errors.</p>
</div>
<div class="section" id="celery-configuration">
<h2>Celery configuration<a class="headerlink" href="#celery-configuration" title="Permalink to this headline">¶</a></h2>
<p>Kallithea can use the distributed task queue system <a class="reference external" href="http://celeryproject.org/">Celery</a> to run tasks like
cloning repositories or sending emails.</p>
<p>Kallithea will in most setups work perfectly fine out of the box (without
Celery), executing all tasks in the web server process. Some tasks can however
take some time to run and it can be better to run such tasks asynchronously in
a separate process so the web server can focus on serving web requests.</p>
<p>For installation and configuration of Celery, see the <a class="reference external" href="http://docs.celeryproject.org/en/latest/getting-started/index.html">Celery documentation</a>.
Note that Celery requires a message broker service like <a class="reference external" href="http://www.rabbitmq.com/">RabbitMQ</a> (recommended)
or <a class="reference external" href="http://redis.io/">Redis</a>.</p>
<p>The use of Celery is configured in the Kallithea ini configuration file.
To enable it, simply set:</p>
<div class="highlight-none notranslate"><div class="highlight"><pre><span></span>use_celery = true
</pre></div>
</div>
<p>and add or change the <code class="docutils literal notranslate"><span class="pre">celery.*</span></code> and <code class="docutils literal notranslate"><span class="pre">broker.*</span></code> configuration variables.</p>
<p>Remember that the ini files use the format with ‘.’ and not with ‘_’ like
Celery. So for example setting <cite>BROKER_HOST</cite> in Celery means setting
<cite>broker.host</cite> in the configuration file.</p>
<p>To start the Celery process, run:</p>
<div class="highlight-none notranslate"><div class="highlight"><pre><span></span>paster celeryd &lt;configfile.ini&gt;
</pre></div>
</div>
<div class="admonition note">
<p class="first admonition-title">Note</p>
<p class="last">Make sure you run this command from the same virtualenv, and with the same
user that Kallithea runs.</p>
</div>
</div>
<div class="section" id="https-support">
<h2>HTTPS support<a class="headerlink" href="#https-support" title="Permalink to this headline">¶</a></h2>
<p>Kallithea will by default generate URLs based on the WSGI environment.</p>
<p>Alternatively, you can use some special configuration settings to control
directly which scheme/protocol Kallithea will use when generating URLs:</p>
<ul class="simple">
<li>With <code class="docutils literal notranslate"><span class="pre">https_fixup</span> <span class="pre">=</span> <span class="pre">true</span></code>, the scheme will be taken from the
<code class="docutils literal notranslate"><span class="pre">X-Url-Scheme</span></code>, <code class="docutils literal notranslate"><span class="pre">X-Forwarded-Scheme</span></code> or <code class="docutils literal notranslate"><span class="pre">X-Forwarded-Proto</span></code> HTTP header
(default <code class="docutils literal notranslate"><span class="pre">http</span></code>).</li>
<li>With <code class="docutils literal notranslate"><span class="pre">force_https</span> <span class="pre">=</span> <span class="pre">true</span></code> the default will be <code class="docutils literal notranslate"><span class="pre">https</span></code>.</li>
<li>With <code class="docutils literal notranslate"><span class="pre">use_htsts</span> <span class="pre">=</span> <span class="pre">true</span></code>, Kallithea will set <code class="docutils literal notranslate"><span class="pre">Strict-Transport-Security</span></code> when using https.</li>
</ul>
</div>
<div class="section" id="nginx-virtual-host-example">
<h2>Nginx virtual host example<a class="headerlink" href="#nginx-virtual-host-example" title="Permalink to this headline">¶</a></h2>
<p>Sample config for Nginx using proxy:</p>
<div class="highlight-nginx notranslate"><div class="highlight"><pre><span></span><span class="k">upstream</span> <span class="s">kallithea</span> <span class="p">{</span>
    <span class="kn">server</span> <span class="n">127.0.0.1</span><span class="p">:</span><span class="mi">5000</span><span class="p">;</span>
    <span class="c1"># add more instances for load balancing</span>
    <span class="c1">#server 127.0.0.1:5001;</span>
    <span class="c1">#server 127.0.0.1:5002;</span>
<span class="p">}</span>

<span class="c1">## gist alias</span>
<span class="k">server</span> <span class="p">{</span>
   <span class="kn">listen</span>          <span class="mi">443</span><span class="p">;</span>
   <span class="kn">server_name</span>     <span class="s">gist.example.com</span><span class="p">;</span>
   <span class="kn">access_log</span>      <span class="s">/var/log/nginx/gist.access.log</span><span class="p">;</span>
   <span class="kn">error_log</span>       <span class="s">/var/log/nginx/gist.error.log</span><span class="p">;</span>

   <span class="kn">ssl</span> <span class="no">on</span><span class="p">;</span>
   <span class="kn">ssl_certificate</span>     <span class="s">gist.your.kallithea.server.crt</span><span class="p">;</span>
   <span class="kn">ssl_certificate_key</span> <span class="s">gist.your.kallithea.server.key</span><span class="p">;</span>

   <span class="kn">ssl_session_timeout</span> <span class="mi">5m</span><span class="p">;</span>

   <span class="kn">ssl_protocols</span> <span class="s">SSLv3</span> <span class="s">TLSv1</span><span class="p">;</span>
   <span class="kn">ssl_ciphers</span> <span class="s">DHE-RSA-AES256-SHA:DHE-RSA-AES128-SHA:EDH-RSA-DES-CBC3-SHA:AES256-SHA:DES-CBC3-SHA:AES128-SHA:RC4-SHA:RC4-MD5</span><span class="p">;</span>
   <span class="kn">ssl_prefer_server_ciphers</span> <span class="no">on</span><span class="p">;</span>

   <span class="kn">rewrite</span> <span class="s">^/(.+)</span>$ <span class="s">https://kallithea.example.com/_admin/gists/</span><span class="nv">$1</span><span class="p">;</span>
   <span class="kn">rewrite</span> <span class="s">(.*)</span>    <span class="s">https://kallithea.example.com/_admin/gists</span><span class="p">;</span>
<span class="p">}</span>

<span class="k">server</span> <span class="p">{</span>
   <span class="kn">listen</span>          <span class="mi">443</span><span class="p">;</span>
   <span class="kn">server_name</span>     <span class="s">kallithea.example.com</span>
   <span class="s">access_log</span>      <span class="s">/var/log/nginx/kallithea.access.log</span><span class="p">;</span>
   <span class="kn">error_log</span>       <span class="s">/var/log/nginx/kallithea.error.log</span><span class="p">;</span>

   <span class="kn">ssl</span> <span class="no">on</span><span class="p">;</span>
   <span class="kn">ssl_certificate</span>     <span class="s">your.kallithea.server.crt</span><span class="p">;</span>
   <span class="kn">ssl_certificate_key</span> <span class="s">your.kallithea.server.key</span><span class="p">;</span>

   <span class="kn">ssl_session_timeout</span> <span class="mi">5m</span><span class="p">;</span>

   <span class="kn">ssl_protocols</span> <span class="s">SSLv3</span> <span class="s">TLSv1</span><span class="p">;</span>
   <span class="kn">ssl_ciphers</span> <span class="s">DHE-RSA-AES256-SHA:DHE-RSA-AES128-SHA:EDH-RSA-DES-CBC3-SHA:AES256-SHA:DES-CBC3-SHA:AES128-SHA:RC4-SHA:RC4-MD5</span><span class="p">;</span>
   <span class="kn">ssl_prefer_server_ciphers</span> <span class="no">on</span><span class="p">;</span>

   <span class="c1">## uncomment root directive if you want to serve static files by nginx</span>
   <span class="c1">## requires static_files = false in .ini file</span>
   <span class="c1">#root /path/to/installation/kallithea/public;</span>
   <span class="kn">include</span>         <span class="s">/etc/nginx/proxy.conf</span><span class="p">;</span>
   <span class="kn">location</span> <span class="s">/</span> <span class="p">{</span>
        <span class="kn">try_files</span> <span class="nv">$uri</span> <span class="s">@kallithea</span><span class="p">;</span>
   <span class="p">}</span>

   <span class="kn">location</span> <span class="s">@kallithea</span> <span class="p">{</span>
        <span class="kn">proxy_pass</span>      <span class="s">http://127.0.0.1:5000</span><span class="p">;</span>
   <span class="p">}</span>

<span class="p">}</span>
</pre></div>
</div>
<p>Here’s the proxy.conf. It’s tuned so it will not timeout on long
pushes or large pushes:</p>
<div class="highlight-none notranslate"><div class="highlight"><pre><span></span>proxy_redirect              off;
proxy_set_header            Host $host;
## needed for container auth
#proxy_set_header            REMOTE_USER $remote_user;
#proxy_set_header            X-Forwarded-User $remote_user;
proxy_set_header            X-Url-Scheme $scheme;
proxy_set_header            X-Host $http_host;
proxy_set_header            X-Real-IP $remote_addr;
proxy_set_header            X-Forwarded-For $proxy_add_x_forwarded_for;
proxy_set_header            Proxy-host $proxy_host;
proxy_buffering             off;
proxy_connect_timeout       7200;
proxy_send_timeout          7200;
proxy_read_timeout          7200;
proxy_buffers               8 32k;
client_max_body_size        1024m;
client_body_buffer_size     128k;
large_client_header_buffers 8 64k;
</pre></div>
</div>
</div>
<div class="section" id="apache-virtual-host-reverse-proxy-example">
<h2>Apache virtual host reverse proxy example<a class="headerlink" href="#apache-virtual-host-reverse-proxy-example" title="Permalink to this headline">¶</a></h2>
<p>Here is a sample configuration file for Apache using proxy:</p>
<div class="highlight-apache notranslate"><div class="highlight"><pre><span></span><span class="nt">&lt;VirtualHost</span> <span class="s">*:80</span><span class="nt">&gt;</span>
        <span class="nb">ServerName</span> kallithea.example.com

        <span class="nt">&lt;Proxy</span> <span class="s">*</span><span class="nt">&gt;</span>
          <span class="c"># For Apache 2.4 and later:</span>
          <span class="nb">Require</span> <span class="k">all</span> granted

          <span class="c"># For Apache 2.2 and earlier, instead use:</span>
          <span class="c"># Order allow,deny</span>
          <span class="c"># Allow from all</span>
        <span class="nt">&lt;/Proxy&gt;</span>

        <span class="c">#important !</span>
        <span class="c">#Directive to properly generate url (clone url) for pylons</span>
        <span class="nb">ProxyPreserveHost</span> <span class="k">On</span>

        <span class="c">#kallithea instance</span>
        <span class="nb">ProxyPass</span> / http://127.0.0.1:5000/
        <span class="nb">ProxyPassReverse</span> / http://127.0.0.1:5000/

        <span class="c">#to enable https use line below</span>
        <span class="c">#SetEnvIf X-Url-Scheme https HTTPS=1</span>
<span class="nt">&lt;/VirtualHost&gt;</span>
</pre></div>
</div>
<p>Additional tutorial
<a class="reference external" href="http://pylonsbook.com/en/1.1/deployment.html#using-apache-to-proxy-requests-to-pylons">http://pylonsbook.com/en/1.1/deployment.html#using-apache-to-proxy-requests-to-pylons</a></p>
</div>
<div class="section" id="apache-as-subdirectory">
<h2>Apache as subdirectory<a class="headerlink" href="#apache-as-subdirectory" title="Permalink to this headline">¶</a></h2>
<p>Apache subdirectory part:</p>
<div class="highlight-apache notranslate"><div class="highlight"><pre><span></span>&lt;Location /&lt;someprefix&gt; &gt;
  ProxyPass http://127.0.0.1:5000/&lt;someprefix&gt;
  ProxyPassReverse http://127.0.0.1:5000/&lt;someprefix&gt;
  SetEnvIf X-Url-Scheme https HTTPS=1
&lt;/Location&gt;
</pre></div>
</div>
<p>Besides the regular apache setup you will need to add the following line
into <code class="docutils literal notranslate"><span class="pre">[app:main]</span></code> section of your .ini file:</p>
<div class="highlight-none notranslate"><div class="highlight"><pre><span></span>filter-with = proxy-prefix
</pre></div>
</div>
<p>Add the following at the end of the .ini file:</p>
<div class="highlight-none notranslate"><div class="highlight"><pre><span></span>[filter:proxy-prefix]
use = egg:PasteDeploy#prefix
prefix = /&lt;someprefix&gt;
</pre></div>
</div>
<p>then change <code class="docutils literal notranslate"><span class="pre">&lt;someprefix&gt;</span></code> into your chosen prefix</p>
</div>
<div class="section" id="apache-with-mod-wsgi">
<h2>Apache with mod_wsgi<a class="headerlink" href="#apache-with-mod-wsgi" title="Permalink to this headline">¶</a></h2>
<p>Alternatively, Kallithea can be set up with Apache under mod_wsgi. For
that, you’ll need to:</p>
<ul>
<li><p class="first">Install mod_wsgi. If using a Debian-based distro, you can install
the package libapache2-mod-wsgi:</p>
<div class="highlight-none notranslate"><div class="highlight"><pre><span></span>aptitude install libapache2-mod-wsgi
</pre></div>
</div>
</li>
<li><p class="first">Enable mod_wsgi:</p>
<div class="highlight-none notranslate"><div class="highlight"><pre><span></span>a2enmod wsgi
</pre></div>
</div>
</li>
<li><p class="first">Add global Apache configuration to tell mod_wsgi that Python only will be
used in the WSGI processes and shouldn’t be initialized in the Apache
processes:</p>
<div class="highlight-none notranslate"><div class="highlight"><pre><span></span>WSGIRestrictEmbedded On
</pre></div>
</div>
</li>
<li><p class="first">Create a wsgi dispatch script, like the one below. Make sure you
check that the paths correctly point to where you installed Kallithea
and its Python Virtual Environment.</p>
</li>
<li><p class="first">Enable the <code class="docutils literal notranslate"><span class="pre">WSGIScriptAlias</span></code> directive for the WSGI dispatch script,
as in the following example. Once again, check the paths are
correctly specified.</p>
</li>
</ul>
<p>Here is a sample excerpt from an Apache Virtual Host configuration file:</p>
<div class="highlight-apache notranslate"><div class="highlight"><pre><span></span><span class="nb">WSGIDaemonProcess</span> kallithea processes=5 threads=1 maximum-requests=100 \
    python-home=/srv/kallithea/venv
<span class="nb">WSGIProcessGroup</span> kallithea
<span class="nb">WSGIScriptAlias</span> / <span class="sx">/srv/kallithea/dispatch.wsgi</span>
<span class="nb">WSGIPassAuthorization</span> <span class="k">On</span>
</pre></div>
</div>
<p>Or if using a dispatcher WSGI script with proper virtualenv activation:</p>
<div class="highlight-apache notranslate"><div class="highlight"><pre><span></span><span class="nb">WSGIDaemonProcess</span> kallithea processes=5 threads=1 maximum-requests=100
<span class="nb">WSGIProcessGroup</span> kallithea
<span class="nb">WSGIScriptAlias</span> / <span class="sx">/srv/kallithea/dispatch.wsgi</span>
<span class="nb">WSGIPassAuthorization</span> <span class="k">On</span>
</pre></div>
</div>
<p>Apache will by default run as a special Apache user, on Linux systems
usually <code class="docutils literal notranslate"><span class="pre">www-data</span></code> or <code class="docutils literal notranslate"><span class="pre">apache</span></code>. If you need to have the repositories
directory owned by a different user, use the user and group options to
WSGIDaemonProcess to set the name of the user and group.</p>
<div class="admonition note">
<p class="first admonition-title">Note</p>
<p class="last">If running Kallithea in multiprocess mode,
make sure you set <code class="docutils literal notranslate"><span class="pre">instance_id</span> <span class="pre">=</span> <span class="pre">*</span></code> in the configuration so each process
gets it’s own cache invalidation key.</p>
</div>
<p>Example WSGI dispatch script:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">os</span>
<span class="n">os</span><span class="o">.</span><span class="n">environ</span><span class="p">[</span><span class="s2">&quot;HGENCODING&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="s2">&quot;UTF-8&quot;</span>
<span class="n">os</span><span class="o">.</span><span class="n">environ</span><span class="p">[</span><span class="s1">&#39;PYTHON_EGG_CACHE&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="s1">&#39;/srv/kallithea/.egg-cache&#39;</span>

<span class="c1"># sometimes it&#39;s needed to set the curent dir</span>
<span class="n">os</span><span class="o">.</span><span class="n">chdir</span><span class="p">(</span><span class="s1">&#39;/srv/kallithea/&#39;</span><span class="p">)</span>

<span class="kn">import</span> <span class="nn">site</span>
<span class="n">site</span><span class="o">.</span><span class="n">addsitedir</span><span class="p">(</span><span class="s2">&quot;/srv/kallithea/venv/lib/python2.7/site-packages&quot;</span><span class="p">)</span>

<span class="n">ini</span> <span class="o">=</span> <span class="s1">&#39;/srv/kallithea/my.ini&#39;</span>
<span class="kn">from</span> <span class="nn">paste.script.util.logging_config</span> <span class="kn">import</span> <span class="n">fileConfig</span>
<span class="n">fileConfig</span><span class="p">(</span><span class="n">ini</span><span class="p">)</span>
<span class="kn">from</span> <span class="nn">paste.deploy</span> <span class="kn">import</span> <span class="n">loadapp</span>
<span class="n">application</span> <span class="o">=</span> <span class="n">loadapp</span><span class="p">(</span><span class="s1">&#39;config:&#39;</span> <span class="o">+</span> <span class="n">ini</span><span class="p">)</span>
</pre></div>
</div>
<p>Or using proper virtualenv activation:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">activate_this</span> <span class="o">=</span> <span class="s1">&#39;/srv/kallithea/venv/bin/activate_this.py&#39;</span>
<span class="nb">execfile</span><span class="p">(</span><span class="n">activate_this</span><span class="p">,</span> <span class="nb">dict</span><span class="p">(</span><span class="vm">__file__</span><span class="o">=</span><span class="n">activate_this</span><span class="p">))</span>

<span class="kn">import</span> <span class="nn">os</span>
<span class="n">os</span><span class="o">.</span><span class="n">environ</span><span class="p">[</span><span class="s1">&#39;HOME&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="s1">&#39;/srv/kallithea&#39;</span>

<span class="n">ini</span> <span class="o">=</span> <span class="s1">&#39;/srv/kallithea/kallithea.ini&#39;</span>
<span class="kn">from</span> <span class="nn">paste.script.util.logging_config</span> <span class="kn">import</span> <span class="n">fileConfig</span>
<span class="n">fileConfig</span><span class="p">(</span><span class="n">ini</span><span class="p">)</span>
<span class="kn">from</span> <span class="nn">paste.deploy</span> <span class="kn">import</span> <span class="n">loadapp</span>
<span class="n">application</span> <span class="o">=</span> <span class="n">loadapp</span><span class="p">(</span><span class="s1">&#39;config:&#39;</span> <span class="o">+</span> <span class="n">ini</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="section" id="other-configuration-files">
<h2>Other configuration files<a class="headerlink" href="#other-configuration-files" title="Permalink to this headline">¶</a></h2>
<p>A number of <a class="reference external" href="https://kallithea-scm.org/repos/kallithea/files/tip/init.d/.">example init.d scripts</a> can be found in
the <code class="docutils literal notranslate"><span class="pre">init.d</span></code> directory of the Kallithea source.</p>
</div>
</div>


          </div>
        </div>
      </div>
      <div class="sphinxsidebar" role="navigation" aria-label="main navigation">
        <div class="sphinxsidebarwrapper">
<div style="text-align:center;margin:30px 0;">
  <img src="_static/kallithea-logo.svg" width="200px"/>
</div>
<h3>Support Kallithea development</h3>
<div style="text-align:center">
<form action="https://www.paypal.com/cgi-bin/webscr" method="post" target="_top">
<input type="hidden" name="cmd" value="_s-xclick">
<input type="hidden" name="hosted_button_id" value="EYXFS3SQPHYUL">
<input type="image" src="https://www.paypalobjects.com/en_US/i/btn/btn_donateCC_LG.gif" border="0" name="submit" alt="PayPal &ndash; The safer, easier way to pay online!">
<img alt="" border="0" src="https://www.paypalobjects.com/en_US/i/scr/pixel.gif" width="1" height="1">
</form>
    <div style="padding:5px">
     <a href="https://flattr.com/thing/922714/Donate-to-Software-Freedom-Conservancy" target="_blank">
     <img src="http://api.flattr.com/button/flattr-badge-large.png" alt="Flattr this" title="Flattr this" border="0" /></a>
    </div>
</div>

  <h3><a href="index.html">Table of Contents</a></h3>
  <ul>
<li><a class="reference internal" href="#">Setup</a><ul>
<li><a class="reference internal" href="#setting-up-kallithea">Setting up Kallithea</a></li>
<li><a class="reference internal" href="#extensions">Extensions</a></li>
<li><a class="reference internal" href="#using-kallithea-with-ssh">Using Kallithea with SSH</a></li>
<li><a class="reference internal" href="#setting-up-whoosh-full-text-search">Setting up Whoosh full text search</a></li>
<li><a class="reference internal" href="#setting-up-ldap-support">Setting up LDAP support</a><ul>
<li><a class="reference internal" href="#active-directory">Active Directory</a></li>
</ul>
</li>
<li><a class="reference internal" href="#authentication-by-container-or-reverse-proxy">Authentication by container or reverse-proxy</a><ul>
<li><a class="reference internal" href="#container-based-authentication">Container-based authentication</a></li>
<li><a class="reference internal" href="#proxy-pass-through-authentication">Proxy pass-through authentication</a></li>
</ul>
</li>
<li><a class="reference internal" href="#integration-with-issue-trackers">Integration with issue trackers</a></li>
<li><a class="reference internal" href="#hook-management">Hook management</a></li>
<li><a class="reference internal" href="#changing-default-encoding">Changing default encoding</a></li>
<li><a class="reference internal" href="#celery-configuration">Celery configuration</a></li>
<li><a class="reference internal" href="#https-support">HTTPS support</a></li>
<li><a class="reference internal" href="#nginx-virtual-host-example">Nginx virtual host example</a></li>
<li><a class="reference internal" href="#apache-virtual-host-reverse-proxy-example">Apache virtual host reverse proxy example</a></li>
<li><a class="reference internal" href="#apache-as-subdirectory">Apache as subdirectory</a></li>
<li><a class="reference internal" href="#apache-with-mod-wsgi">Apache with mod_wsgi</a></li>
<li><a class="reference internal" href="#other-configuration-files">Other configuration files</a></li>
</ul>
</li>
</ul>

  <h4>Previous topic</h4>
  <p class="topless"><a href="installation_iis.html"
                        title="previous chapter">Installing Kallithea on Microsoft Internet Information Services (IIS)</a></p>
  <h4>Next topic</h4>
  <p class="topless"><a href="installation_puppet.html"
                        title="next chapter">Installation and setup using Puppet</a></p>
  <div role="note" aria-label="source link">
    <h3>This Page</h3>
    <ul class="this-page-menu">
      <li><a href="_sources/setup.rst.txt"
            rel="nofollow">Show Source</a></li>
    </ul>
   </div>
<div id="searchbox" style="display: none" role="search">
  <h3>Quick search</h3>
    <div class="searchformwrapper">
    <form class="search" action="search.html" method="get">
      <input type="text" name="q" />
      <input type="submit" value="Go" />
      <input type="hidden" name="check_keywords" value="yes" />
      <input type="hidden" name="area" value="default" />
    </form>
    </div>
</div>
<script type="text/javascript">$('#searchbox').show(0);</script>
        </div>
      </div>
      <div class="clearer"></div>
    </div>
    <div class="related" role="navigation" aria-label="related navigation">
      <h3>Navigation</h3>
      <ul>
        <li class="right" style="margin-right: 10px">
          <a href="genindex.html" title="General Index"
             >index</a></li>
        <li class="right" >
          <a href="py-modindex.html" title="Python Module Index"
             >modules</a> |</li>
        <li class="right" >
          <a href="installation_puppet.html" title="Installation and setup using Puppet"
             >next</a> |</li>
        <li class="right" >
          <a href="installation_iis.html" title="Installing Kallithea on Microsoft Internet Information Services (IIS)"
             >previous</a> |</li>
        <li class="nav-item nav-item-0"><a href="index.html">Kallithea 0.3.7 documentation</a> &#187;</li> 
      </ul>
    </div>
    <div class="footer" role="contentinfo">
        &#169; Copyright 2010-2016 by various authors, licensed as GPLv3..
      Created using <a href="http://sphinx-doc.org/">Sphinx</a> 1.8.4.
    </div>
  </body>
</html>